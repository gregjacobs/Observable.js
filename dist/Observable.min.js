/*!
 * Observable.js
 * Version 0.1.0
 *
 * Copyright(c) 2006-2009 Sencha, Inc.
 * MIT Licensed. http://www.opensource.org/licenses/mit-license.php
 *
 * Copyright(c) 2013 Gregory Jacobs.
 * MIT Licensed. http://www.opensource.org/licenses/mit-license.php
 *
 * https://github.com/gregjacobs/Observable.js
 */
!function(a,b){"function"==typeof define&&define.amd?define(["lodash","Class"],b):a.Observable=b(a._,a.Class)}(this,function(a,b){function c(a,b,c,d){return c.task=new j,function(){c.task.delay(b.buffer,a,d,f(arguments))}}function d(a,b,c,d){return function(){return b.removeListener(c,d),a.apply(d,arguments)}}function e(a,b,c,d){return function(){var e=new j;c.tasks||(c.tasks=[]),c.tasks.push(e),e.delay(b.delay||10,a,d,f(arguments))}}var f=a.toArray,g=a.isObject,h=!0,i=!1,j=function(a,b,c){var d,e=this,f=function(){clearInterval(d),d=null,a.apply(b,c||[])};e.delay=function(g,h,i,j){e.cancel(),a=h||a,b=i||b,c=j||c,d=setInterval(f,g)},e.cancel=function(){d&&(clearInterval(d),d=null)},e.isPending=function(){return!!d}},k=function(a,b){this.name=b,this.obj=a,this.listeners=[]};k.prototype={addListener:function(a,b,c){var d,e=this;b=b||e.obj,e.isListening(a,b)||(d=e.createListener(a,b,c),e.firing&&(e.listeners=e.listeners.slice(0)),e.listeners.push(d))},createListener:function(a,b,f){f=f||{},b=b||this.obj;var g={fn:a,scope:b,options:f},h=a;return f.delay&&(h=e(h,f,g,b)),f.single&&(h=d(h,this,a,b)),f.buffer&&(h=c(h,f,g,b)),g.fireFn=h,g},findListener:function(a,b){for(var c,d,e=this.listeners,f=e.length;f--;)if(c=e[f],c&&(d=c.scope,c.fn===a&&(d===b||d===this.obj)))return f;return-1},isListening:function(a,b){return-1!==this.findListener(a,b)},removeListener:function(a,b){var c,d,e,f=this,g=i;if(-1!==(c=f.findListener(a,b))){if(f.firing&&(f.listeners=f.listeners.slice(0)),d=f.listeners[c],d.task&&(d.task.cancel(),delete d.task),e=d.tasks&&d.tasks.length){for(;e--;)d.tasks[e].cancel();delete d.tasks}f.listeners.splice(c,1),g=h}return g},clearListeners:function(){for(var a=this,b=a.listeners,c=b.length;c--;)a.removeListener(b[c].fn,b[c].scope)},fire:function(){var a,b=this,c=f(arguments),d=b.listeners,e=d.length,g=0,j=!1;if(e>0)for(b.firing=h;e>g;g++)a=d[g],a&&a.fireFn.apply(a.scope||b.obj||window,c)===i&&(j=!0);return b.firing=i,j?!1:!0}};var l=b.extend(Object,{filterOptRe:/^(?:scope|delay|buffer|single)$/,constructor:function(){var a=this,b=a.events;a.events=b||{},a.listeners&&(a.on(a.listeners),delete a.listeners),this.addEvents("all")},fireEvent:function(){var a,b=f(arguments),c=b[0].toLowerCase(),d=this,e=h,i=d.events[c];return d.eventsSuspended===h?(a=d.eventQueue,a&&a.push(b)):g(i)&&(b.shift(),e=i.fire.apply(i,b)),"all"!==c&&this.fireEvent.apply(this,["all"].concat(Array.prototype.slice.call(arguments,0))),e},addListener:function(b,c,d,e){var f,i,j,l=this;if(g(b)){e=b;for(f in e)i=e[f],l.filterOptRe.test(f)||l.addListener(f,i.fn||i,i.scope||e.scope,i.fn?i:e)}else b=b.toLowerCase(),j=l.events[b]||h,a.isBoolean(j)&&(l.events[b]=j=new k(l,b)),j.addListener(c,d,g(e)?e:{});return this},removeListener:function(a,b,c){if("object"==typeof a){var d=a;for(var e in d)this.removeListener(e,d[e],d.scope)}else{var f=this.events[a.toLowerCase()];g(f)&&f.removeListener(b,c)}return this},purgeListeners:function(){var a,b,c=this.events;for(b in c)a=c[b],g(a)&&a.clearListeners()},addEvents:function(b){var c=this;if(c.events=c.events||{},a.isString(b))for(var d=arguments,e=d.length;e--;)c.events[d[e]]=c.events[d[e]]||h;else a.defaults(c.events,b)},hasListener:function(a){var b=this.events[a];return g(b)&&b.listeners.length>0},suspendEvents:function(a){this.eventsSuspended=h,a&&!this.eventQueue&&(this.eventQueue=[])},resumeEvents:function(){var a=this,b=a.eventQueue||[];a.eventsSuspended=i,delete a.eventQueue;for(var c=0,d=b.length;d>c;c++){var e=a.fireEvent.apply(a,b[c]);if(e===!1)return}}}),m=l.prototype;return m.on=m.addListener,m.un=m.removeListener,l});